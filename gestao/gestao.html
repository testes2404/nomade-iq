<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Painel de Gestão – Nômade IQ</title>

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Supabase UMD v2 -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.45.4/dist/umd/supabase.min.js"></script>

  <!-- CSS externo -->
  <link rel="stylesheet" href="../css/gestao.css">
</head>
<body class="min-h-screen text-slate-100 antialiased flex flex-col">

  <!-- ========= HEADER / MENU SUPERIOR ========= -->
  <header class="bg-slate-950/80 backdrop-blur border-b border-slate-800 sticky top-0 z-40">
    <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between">
      <!-- Logo + título -->
      <div class="flex items-center gap-3">
        <img src="../recursos/logo.png" alt="Logo Nômade IQ" class="h-8 w-auto"
             onerror="this.onerror=null; this.src='../recursos/logo.png';">
        <div class="flex flex-col leading-tight">
          <span class="text-sm uppercase tracking-[0.25em] text-slate-400">Painel</span>
          <span class="text-lg font-semibold text-slate-50">Gestão de Conteúdos</span>
        </div>
      </div>

      <!-- Menu simples (futuro) -->
      <nav class="flex items-center gap-3 text-sm">
        <span class="px-3 py-1 rounded-full bg-slate-900 text-indigo-300 border border-indigo-500/40">
          Master
        </span>
        <a href="../index.html" class="px-3 py-1 rounded-lg border border-slate-700 text-slate-300 hover:bg-slate-800 transition">
          Voltar ao site
        </a>
      </nav>
    </div>
  </header>

  <!-- ========= CONTEÚDO PRINCIPAL ========= -->
  <main class="flex-1">
    <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-10 flex gap-6">
      
      <!-- ========= MENU LATERAL ========= -->
      <aside class="w-56 shrink-0 bg-slate-950/80 border border-slate-800 rounded-2xl p-4 h-max">
        <h2 class="text-xs font-semibold uppercase tracking-wide text-slate-400 mb-3">
          Seções do painel
        </h2>

        <!-- Botão 1 -->
        <button
          id="btn-redacao-principal"
          class="w-full inline-flex items-center justify-between gap-2 rounded-xl bg-slate-900/80 border border-slate-700 px-3 py-2 text-sm text-slate-100 hover:border-indigo-500 hover:bg-slate-900 hover:text-indigo-200 transition"
        >
          <span>Redação página principal</span>
          <span class="inline-flex items-center justify-center h-5 w-5 rounded-full bg-indigo-600/20 text-[10px] text-indigo-300 border border-indigo-500/40">
            TXT
          </span>
        </button>

        <!-- Botão 2 -->
        <button
          id="btn-redacao-comissario"
          class="mt-2 w-full inline-flex items-center justify-between gap-2 rounded-xl bg-slate-900/80 border border-slate-700 px-3 py-2 text-sm text-slate-100 hover:border-indigo-500 hover:bg-slate-900 hover:text-indigo-200 transition"
        >
          <span>Redação de conteúdo comissário</span>
          <span class="inline-flex items-center justify-center h-5 w-5 rounded-full bg-indigo-600/20 text-[10px] text-indigo-300 border border-indigo-500/40">
            ART
          </span>
        </button>

        <!-- Botão 3 – ANÁLISES & RELATÓRIOS -->
        <button
          id="btn-analise-relatorios"
          class="mt-2 w-full inline-flex items-center justify-between gap-2 rounded-xl bg-slate-900/80 border border-slate-700 px-3 py-2 text-sm text-slate-100 hover:border-emerald-500 hover:bg-slate-900 hover:text-emerald-200 transition"
        >
          <span>Análises &amp; Relatórios</span>
          <span class="inline-flex items-center justify-center h-5 w-5 rounded-full bg-emerald-600/20 text-[10px] text-emerald-300 border border-emerald-500/40">
            BI
          </span>
        </button>
      </aside>

      <!-- ========= ÁREA DE CONTEÚDO ========= -->
      <div class="flex-1">
        <!-- Placeholder padrão (antes de clicar em qualquer coisa) -->
        <div id="view-placeholder" class="h-full min-h-[260px] flex items-center justify-center text-sm text-slate-500 border border-dashed border-slate-800/70 rounded-2xl bg-slate-950/40">
          Selecione uma opção no menu ao lado para gerenciar os conteúdos.
        </div>

        <!-- ================= VIEW 1 – REDAÇÃO PÁGINA PRINCIPAL ================= -->
        <div id="view-redacao-principal" class="space-y-10 hidden mt-0">
          <!-- Título da página -->
          <section>
            <h1 class="text-2xl sm:text-3xl font-bold tracking-tight text-slate-50 mb-2">
              Biblioteca de Textos (.txt)
            </h1>
            <p class="text-sm text-slate-400 max-w-2xl">
              Suba aqui os arquivos <span class="font-semibold text-slate-200">.txt</span> com novidades,
              roteiros ou conteúdos diários da <span class="font-semibold">página principal</span>.
              O último texto enviado sempre aparece em primeiro na lista abaixo.
            </p>
          </section>

          <div class="grid lg:grid-cols-[minmax(0,1.2fr)_minmax(0,1fr)] gap-8 items-start">
            <!-- ========= COLUNA ESQUERDA: FORM NOVO TEXTO ========= -->
            <section class="bg-slate-950/70 border border-slate-800/70 rounded-2xl p-6 sm:p-7 shadow-xl shadow-slate-950/40">
              <h2 class="text-lg font-semibold text-slate-50 mb-4 flex items-center gap-2">
                <span class="inline-flex h-8 w-8 items-center justify-center rounded-full bg-indigo-600/20 text-indigo-300 border border-indigo-500/40 text-sm">
                  1
                </span>
                Novo texto .txt
              </h2>

              <form id="txt-form" class="space-y-6">
                <!-- TÍTULO -->
                <div>
                  <label for="txt-title" class="block text-sm font-medium text-slate-200 mb-1">
                    Título do texto
                  </label>
                  <input
                    type="text"
                    id="txt-title"
                    class="mt-1 block w-full rounded-lg border border-slate-700 bg-slate-900/60 px-3 py-2 text-sm text-slate-100 placeholder:text-slate-500 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-500/60 outline-none"
                    placeholder="Ex.: Novidade do dia – Custo de vida em Lisboa"
                    required
                  >
                </div>

                <!-- DROPZONE / INPUT DE ARQUIVO -->
                <div>
                  <label class="block text-sm font-medium text-slate-200 mb-1">
                    Arquivo .txt
                  </label>

                  <div
                    id="dropzone"
                    class="mt-1 flex flex-col items-center justify-center rounded-xl border border-dashed border-slate-700 bg-slate-900/40 px-4 py-6 text-center cursor-pointer transition"
                  >
                    <input
                      type="file"
                      id="txt-file"
                      accept=".txt"
                      class="hidden"
                    >
                    <div class="flex flex-col items-center gap-2">
                      <div class="flex h-10 w-10 items-center justify-center rounded-full bg-slate-800 text-indigo-300">
                        <!-- ícone -->
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.6"
                                d="M9 17v-3m3 3V7m3 10v-5M4 4h16v16H4z"/>
                        </svg>
                      </div>
                      <p class="text-sm text-slate-200">
                        Arraste e solte um arquivo <span class="font-semibold">.txt</span> aqui
                      </p>
                      <p class="text-xs text-slate-500">
                        ou clique para selecionar no seu computador
                      </p>
                      <p id="file-name" class="text-xs text-indigo-300 mt-1 hidden"></p>
                    </div>
                  </div>
                </div>

                <!-- BOTÃO & STATUS -->
                <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3">
                  <button
                    type="submit"
                    id="btn-upload"
                    class="inline-flex items-center justify-center gap-2 rounded-lg bg-indigo-600 px-4 py-2.5 text-sm font-semibold text-white shadow-lg shadow-indigo-900/40 hover:bg-indigo-500 disabled:opacity-60 disabled:cursor-not-allowed transition"
                  >
                    <span id="btn-upload-label">Salvar texto</span>
                    <svg id="btn-upload-spinner" class="h-4 w-4 animate-spin hidden" viewBox="0 0 24 24">
                      <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="3"></circle>
                      <path class="opacity-75" fill="currentColor"
                            d="M4 12a8 8 0 018-8v3a5 5 0 00-5 5H4z"></path>
                    </svg>
                  </button>

                  <p id="upload-status" class="text-xs text-slate-400 sm:text-right min-h-[1.25rem]">
                    <!-- status aqui -->
                  </p>
                </div>
              </form>
            </section>

            <!-- ========= COLUNA DIREITA: LISTA ========= -->
            <section class="bg-slate-950/60 border border-slate-800/70 rounded-2xl p-5 sm:p-6 shadow-xl shadow-slate-950/40">
              <div class="flex items-center justify-between gap-2 mb-4">
                <div>
                  <h2 class="text-base font-semibold text-slate-50">
                    Últimos textos enviados
                  </h2>
                  <p class="text-xs text-slate-500">
                    Sempre do mais recente para o mais antigo.
                  </p>
                </div>
                <button
                  id="btn-reload"
                  class="inline-flex items-center justify-center rounded-full border border-slate-700 bg-slate-900/70 p-2 text-slate-300 hover:bg-slate-800 hover:text-white text-xs transition"
                  title="Recarregar lista"
                >
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.6"
                          d="M4 4v6h6M20 20v-6h-6M5 19A9 9 0 0119 5M19 19A9 9 0 015 5"/>
                  </svg>
                </button>
              </div>

              <div id="txt-list" class="thin-scrollbar max-h-[360px] overflow-y-auto space-y-3 text-sm">
                <p class="text-xs text-slate-500" id="txt-list-empty">
                  Nenhum texto enviado ainda. Salve o primeiro .txt ao lado.
                </p>
              </div>
            </section>
          </div>
        </div>

        <!-- ================= VIEW 2 – REDAÇÃO CONTEÚDO COMISSÁRIO ================= -->
        <div id="view-redacao-comissario" class="space-y-10 hidden mt-0">
          <!-- Título da página -->
          <section>
            <h1 class="text-2xl sm:text-3xl font-bold tracking-tight text-slate-50 mb-2">
              Conteúdos – Trilha do Comissário
            </h1>
            <p class="text-sm text-slate-400 max-w-2xl">
              Aqui você cadastra os artigos da trilha de comissário de voo,
              com imagem de capa, tipo de conteúdo (como no menu da página) e o texto completo.
              Tudo é salvo em uma <span class="font-semibold text-slate-200">tabela exclusiva</span>.
            </p>
          </section>

          <div class="grid lg:grid-cols-[minmax(0,1.2fr)_minmax(0,1fr)] gap-8 items-start">
            <!-- COLUNA ESQUERDA – FORM ARTIGO COMISSÁRIO -->
            <section class="bg-slate-950/70 border border-slate-800/70 rounded-2xl p-6 sm:p-7 shadow-xl shadow-slate-950/40">
              <h2 class="text-lg font-semibold text-slate-50 mb-4 flex items-center gap-2">
                <span class="inline-flex h-8 w-8 items-center justify-center rounded-full bg-indigo-600/20 text-indigo-300 border border-indigo-500/40 text-sm">
                  1
                </span>
                Novo conteúdo do comissário
              </h2>

              <form id="cms-form" class="space-y-6">
                <!-- IMAGEM DE CAPA -->
                <div>
                  <label class="block text-sm font-medium text-slate-200 mb-1">
                    Imagem de capa
                  </label>
                  <div
                    id="cms-cover-dropzone"
                    class="mt-1 flex flex-col items-center justify-center rounded-xl border border-dashed border-slate-700 bg-slate-900/40 px-4 py-5 text-center cursor-pointer transition"
                  >
                    <input
                      type="file"
                      id="cms-cover-file"
                      accept="image/*"
                      class="hidden"
                    >
                    <div class="flex flex-col items-center gap-2">
                      <div class="flex h-10 w-10 items-center justify-center rounded-full bg-slate-800 text-indigo-300">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.6"
                                d="M4 5h16v14H4zM8 11l2.5 3L13 11l3 4"/>
                          <circle cx="9" cy="9" r="1.2" />
                        </svg>
                      </div>
                      <p class="text-sm text-slate-200">
                        Arraste a capa ou clique para selecionar
                      </p>
                      <p class="text-xs text-slate-500">
                        JPG, PNG ou WEBP – tamanho moderado
                      </p>
                      <p id="cms-cover-name" class="text-xs text-indigo-300 mt-1 hidden"></p>
                    </div>
                  </div>
                </div>

                <!-- SELETOR DE TIPO (MENU) -->
                <div>
                  <label class="block text-sm font-medium text-slate-200 mb-2">
                    Tipo de conteúdo (menu)
                  </label>

                  <!-- Botões tipo "pílula" como na imagem -->
                  <div id="cms-menu-buttons" class="inline-flex flex-wrap gap-2 bg-slate-950/80 border border-slate-800 rounded-2xl p-2">
                    <button type="button" data-value="antes" class="cms-menu-btn px-4 py-2 rounded-xl text-xs sm:text-sm bg-indigo-600 text-white font-medium shadow shadow-indigo-900/40">
                      O que saber antes de qualquer coisa?
                    </button>
                    <button type="button" data-value="certificacao" class="cms-menu-btn px-4 py-2 rounded-xl text-xs sm:text-sm bg-slate-900 text-slate-200 border border-slate-700 hover:border-indigo-500 hover:text-indigo-200">
                      O que estudar para a certificação?
                    </button>
                    <button type="button" data-value="depois" class="cms-menu-btn px-4 py-2 rounded-xl text-xs sm:text-sm bg-slate-900 text-slate-200 border border-slate-700 hover:border-indigo-500 hover:text-indigo-200">
                      O que saber depois da certificação?
                    </button>
                    <button type="button" data-value="entrevista" class="cms-menu-btn px-4 py-2 rounded-xl text-xs sm:text-sm bg-slate-900 text-slate-200 border border-slate-700 hover:border-indigo-500 hover:text-indigo-200">
                      Como passar na entrevista?
                    </button>
                  </div>

                  <input type="hidden" id="cms-menu-type" value="antes">
                </div>

                <!-- TÍTULO DO ARTIGO -->
                <div>
                  <label for="cms-title" class="block text-sm font-medium text-slate-200 mb-1">
                    Título do artigo
                  </label>
                  <input
                    type="text"
                    id="cms-title"
                    class="mt-1 block w-full rounded-lg border border-slate-700 bg-slate-900/60 px-3 py-2 text-sm text-slate-100 placeholder:text-slate-500 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-500/60 outline-none"
                    placeholder="Ex.: 7 verdades que ninguém te conta sobre ser comissário(a)"
                    required
                  >
                </div>

                <!-- TEXTO DO ARTIGO -->
                <div>
                  <label for="cms-body" class="block text-sm font-medium text-slate-200 mb-1">
                    Texto do artigo
                  </label>
                  <textarea
                    id="cms-body"
                    rows="8"
                    class="mt-1 block w-full rounded-lg border border-slate-700 bg-slate-900/60 px-3 py-2 text-sm text-slate-100 placeholder:text-slate-500 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-500/60 outline-none resize-y"
                    placeholder="Escreva aqui o conteúdo completo que será exibido na página da trilha..."
                    required
                  ></textarea>
                </div>

                <!-- BOTÃO & STATUS -->
                <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3">
                  <button
                    type="submit"
                    id="cms-btn-save"
                    class="inline-flex items-center justify-center gap-2 rounded-lg bg-indigo-600 px-4 py-2.5 text-sm font-semibold text-white shadow-lg shadow-indigo-900/40 hover:bg-indigo-500 disabled:opacity-60 disabled:cursor-not-allowed transition"
                  >
                    <span id="cms-btn-save-label">Salvar conteúdo</span>
                    <svg id="cms-btn-save-spinner" class="h-4 w-4 animate-spin hidden" viewBox="0 0 24 24">
                      <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="3"></circle>
                      <path class="opacity-75" fill="currentColor"
                            d="M4 12a8 8 0 018-8v3a5 5 0 00-5 5H4z"></path>
                    </svg>
                  </button>

                  <p id="cms-status" class="text-xs text-slate-400 sm:text-right min-h-[1.25rem]">
                    <!-- status aqui -->
                  </p>
                </div>
              </form>
            </section>

            <!-- COLUNA DIREITA – LISTA DE ARTIGOS -->
            <section class="bg-slate-950/60 border border-slate-800/70 rounded-2xl p-5 sm:p-6 shadow-xl shadow-slate-950/40">
              <div class="flex items-center justify-between gap-2 mb-4">
                <div>
                  <h2 class="text-base font-semibold text-slate-50">
                    Conteúdos cadastrados
                  </h2>
                  <p class="text-xs text-slate-500">
                    Filtrados pelo tipo de menu e do mais recente para o mais antigo.
                  </p>
                </div>
                <button
                  id="cms-btn-reload"
                  class="inline-flex items-center justify-center rounded-full border border-slate-700 bg-slate-900/70 p-2 text-slate-300 hover:bg-slate-800 hover:text-white text-xs transition"
                  title="Recarregar lista"
                >
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.6"
                          d="M4 4v6h6M20 20v-6h-6M5 19A9 9 0 0119 5M19 19A9 9 0 015 5"/>
                  </svg>
                </button>
              </div>

              <div id="cms-list" class="thin-scrollbar max-h-[360px] overflow-y-auto space-y-3 text-sm">
                <p class="text-xs text-slate-500" id="cms-list-empty">
                  Nenhum conteúdo cadastrado ainda. Salve o primeiro artigo ao lado.
                </p>
              </div>
            </section>
          </div>
        </div>

        <!-- ================= VIEW 3 – ANÁLISES & RELATÓRIOS ================= -->
        <div id="view-analise" class="space-y-10 hidden mt-0">
          <!-- Título -->
          <section>
            <h1 class="text-2xl sm:text-3xl font-bold tracking-tight text-slate-50 mb-2">
              Análises &amp; Relatórios das Calculadoras
            </h1>
            <p class="text-sm text-slate-400 max-w-2xl">
              Esta área mostra o histórico de cálculos realizados nas ferramentas
              (custo de vida, salários, intercâmbio, viagens, etc.), permitindo
              entender quais destinos e cenários aparecem mais. Aqui também ficará
              o gráfico de uso para trazer o cliente de volta para a plataforma.
            </p>
          </section>

          <div class="grid lg:grid-cols-[minmax(0,1.2fr)_minmax(0,1fr)] gap-8 items-start">
            <!-- Coluna esquerda – gráfico -->
            <section class="bg-slate-950/70 border border-slate-800/70 rounded-2xl p-6 sm:p-7 shadow-xl shadow-slate-950/40">
              <div class="flex items-center justify-between mb-4 gap-3">
                <div>
                  <h2 class="text-lg font-semibold text-slate-50">
                    Distribuição por destino / local
                  </h2>
                  <p class="text-xs text-slate-500">
                    Gráfico com a quantidade de cálculos por cidade, país ou destino.
                  </p>
                </div>

                <div class="flex items-center gap-2">
                  <label for="analytics-filter-tipo" class="text-[11px] text-slate-400">
                    Tipo de cálculo
                  </label>
                  <select
                    id="analytics-filter-tipo"
                    class="rounded-lg border border-slate-700 bg-slate-900/70 text-xs text-slate-100 px-2 py-1 focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/40 outline-none"
                  >
                    <option value="todos">Todos</option>
                    <option value="custo_vida">Custo de vida</option>
                    <option value="intercambio">Intercâmbio</option>
                    <option value="salario">Salário real</option>
                    <option value="viagem">Custo de viagem</option>
                  </select>
                </div>
              </div>

              <div class="bg-slate-950/80 border border-slate-800 rounded-2xl p-4">
                <div id="analytics-chart-placeholder" class="h-64 flex items-center justify-center text-xs text-slate-500">
                  Aqui entra o gráfico (Chart.js) com os dados do Supabase.
                </div>
              </div>
            </section>

            <!-- Coluna direita – lista -->
            <section class="bg-slate-950/60 border border-slate-800/70 rounded-2xl p-5 sm:p-6 shadow-xl shadow-slate-950/40">
              <div class="flex items-center justify-between gap-2 mb-4">
                <div>
                  <h2 class="text-base font-semibold text-slate-50">
                    Últimos cálculos realizados
                  </h2>
                  <p class="text-xs text-slate-500">
                    Histórico com data, tipo de cálculo e destino.
                  </p>
                </div>
                <button
                  id="analytics-btn-reload"
                  class="inline-flex items-center justify-center rounded-full border border-slate-700 bg-slate-900/70 p-2 text-slate-300 hover:bg-slate-800 hover:text-white text-xs transition"
                  title="Recarregar dados"
                >
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.6"
                          d="M4 4v6h6M20 20v-6h-6M5 19A9 9 0 0119 5M19 19A9 9 0 015 5"/>
                  </svg>
                </button>
              </div>

              <div id="analytics-list" class="thin-scrollbar max-h-[360px] overflow-y-auto space-y-3 text-sm">
                <p class="text-xs text-slate-500" id="analytics-list-empty">
                  Nenhum cálculo registrado ainda. Quando as calculadoras forem usadas,
                  os registros aparecerão aqui.
                </p>
              </div>
            </section>
          </div>
        </div>

      </div>

    </div>
  </main>

  <!-- ========= SCRIPT EXTERNO ========= -->
  <script src="../js/gestao.js"></script>
</body>
</html>
